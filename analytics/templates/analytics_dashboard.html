{% load staticfiles %}

<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Semester.ly Analytics</title>
    <!-- Tell the browser to be responsive to screen width -->
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flat-ui/2.2.2/css/flat-ui.css">

    <link rel="stylesheet" href="{% static 'css/analytics/analytics.css' %}">

   
  </head>
  <body>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.3/Chart.min.js"></script>

    <div id="analytics-container">
    </div>

    <h3>Total number of timetables: {{total_timetables}}</h3>

    <h3>Total number of shared timetables: {{total_shared_timetables}}</h3>

    <h4>Total number of Timetables: {{total_timetables}}</h4>

    <h3>Total number of timetables for Spring semester: {{total_timetables_spring}}</h3>

    <h4>Total number of Timetables for Fall semester: {{total_timetables_fall}}</h4>

    <h4>Total number of Timetables for Spring semester: {{total_timetables_spring}}</h4>

    <h4>Total number of JHU Timetables: {{jhu_timetables}}</h4>  

    <!-- <h4>Most popular courses in JHU:</h4>  

    {% for course in jhu_most_popular_courses %}
    <div>
        <p>{{ course.name }}</p>
    </div>
    {% endfor %}


    <h4>Most searched courses in JHU:</h4>  
    {% for course in jhu_most_searched_courses %}
    <div>
        <p>{{ course.name }}</p>
    </div>
    {% endfor %} -->

    <h4>Total number of UOFT Timetables: {{uoft_timetables}}</h4>
    <!-- <h4>Most popular courses in UOFT:</h4>  
    {% for course in uoft_most_popular_courses %}
    <div>
        <p>{{ course.name }}</p>
    </div>
    {% endfor %}

    <h4>Most searched courses in UOFT:</h4>  
    {% for course in uoft_most_searched_courses %}
    <div>
        <p>{{ course.name }}</p>
    </div>
    {% endfor %}-->
    
    <h4>Total number of UMD Timetables: {{umd_timetables}}</h4>
    <!-- <h4>Most popular courses in UMD:</h4>  
    {% for course in umd_most_popular_courses %}
    <div>
        <p>{{ course.name }}</p>
    </div>
    {% endfor %}

    <h4>Most searched courses in UMD:</h4>  
    {% for course in umd_most_searched_courses %}
    <div>
        <p>{{ course.name }}</p>
    </div>
    {% endfor %} -->

    <h4>Total number of Queens Timetables: {{queens_timetables}}</h4>


    <h4>Total signups: {{total_signups}}</h4>

    <script type="text/javascript">
      var jhu_timetables_per_hour = JSON.parse("{{jhu_timetables_per_hour}}");
      var uoft_timetables_per_hour = JSON.parse("{{uoft_timetables_per_hour}}");
      var umd_timetables_per_hour = JSON.parse("{{umd_timetables_per_hour}}");
      var queens_timetables_per_hour = JSON.parse("{{queens_timetables_per_hour}}");
      var jhu_shared_timetables_per_hour = JSON.parse("{{jhu_shared_timetables_per_hour}}");
      var uoft_shared_timetables_per_hour = JSON.parse("{{uoft_shared_timetables_per_hour}}");
      var umd_shared_timetables_per_hour = JSON.parse("{{umd_shared_timetables_per_hour}}");
      var queens_shared_timetables_per_hour = JSON.parse("{{queens_shared_timetables_per_hour}}");
      var number_of_reactions = JSON.parse("{{number_of_reactions|escapejs}}");
      var num_jhu_timetables = JSON.parse("{{jhu_timetables}}");
      var num_uoft_timetables = JSON.parse("{{uoft_timetables}}");
      var num_umd_timetables = JSON.parse("{{umd_timetables}}");
      var num_queens_timetables = JSON.parse("{{queens_timetables}}");
    </script>

    <h3>Number of timetables by school:</h3>
    <canvas id="timetables_by_schools" width="400" height="400"></canvas>

    <h3>Number of timetables created per hour per school for the past 24 hours:</h3>
    <canvas id="timetables_per_hours_chart" width="400" height="400"></canvas>

    <h3>Number of shared timetables per hour per school for the past 24 hours:</h3>
    <canvas id="shared_timetables_per_hours_chart" width="400" height="400"></canvas>

    <h3>Number of each reaction used:</h3>
    <canvas id="reactions_chart" width="400" height="400"></canvas>



    <script>
    Chart.defaults.global.responsive = true;
    var past_24_labels = ["-23", "-22", "-21", "-20", "-19", "-18", "-17","-16", "-15", "-14", "-13", "-12", "-11", "-10","-9", "-8", "-7", "-6", "-5", "-4", "-3", "-2", "-1", "Now"];
    var timetables_per_hour_data = {
        labels: past_24_labels,
        datasets: [
            {
                label: "JHU",
                fill: false,
                lineTension: 0.1,
                backgroundColor: "rgba(61,90,254,0.4)",
                borderColor: "rgba(61,90,254,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(61,90,254,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(61,90,254,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data: jhu_timetables_per_hour,
            },
            {
                label: "UOFT",
                fill: false,
                lineTension: 0.1,
                backgroundColor: "rgba(233,30,99,0.4)",
                borderColor: "rgba(233,30,99,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(233,30,99,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(233,30,99,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data: uoft_timetables_per_hour,
            },
            {
                label: "UMD",
                fill: false,
                lineTension: 0.1,
                backgroundColor: "rgba(0,200,83,0.4)",
                borderColor: "rgba(0,200,83,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(0,200,83,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(0,200,83,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data: umd_timetables_per_hour,
            },
            {
                label: "Queens",
                fill: false,
                lineTension: 0.1,
                backgroundColor: "rgba(255,87,34 ,0.4)",
                borderColor: "rgba(255,87,34 ,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(255,87,34 ,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(255,87,34 ,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data: queens_timetables_per_hour,
            }
        ]
    };
    var shared_timetables_per_hour_data = {
        labels: past_24_labels,
        datasets: [
            {
                label: "JHU",
                fill: false,
                lineTension: 0.1,
                backgroundColor: "rgba(61,90,254,0.4)",
                borderColor: "rgba(61,90,254,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(61,90,254,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(61,90,254,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data: jhu_shared_timetables_per_hour,
            },
            {
                label: "UOFT",
                fill: false,
                lineTension: 0.1,
                backgroundColor: "rgba(233,30,99,0.4)",
                borderColor: "rgba(233,30,99,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(233,30,99,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(233,30,99,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data: uoft_shared_timetables_per_hour,
            },
            {
                label: "UMD",
                fill: false,
                lineTension: 0.1,
                backgroundColor: "rgba(0,200,83,0.4)",
                borderColor: "rgba(0,200,83,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(0,200,83,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(0,200,83,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data: umd_shared_timetables_per_hour,
            },
            {
                label: "Queens",
                fill: false,
                lineTension: 0.1,
                backgroundColor: "rgba(255,87,34 ,0.4)",
                borderColor: "rgba(255,87,34 ,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(255,87,34 ,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(255,87,34 ,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                data: umd_shared_timetables_per_hour,
            }
        ]
    };
    var reactions_data = {
        labels: Object.keys(number_of_reactions),
        datasets: [
            {
                label: "# Uses",
                backgroundColor: "rgba(255,23,68,0.2)",
                borderColor: "rgba(255,23,68,1)",
                borderWidth: 1,
                hoverBackgroundColor: "rgba(255,23,68,0.4)",
                hoverBorderColor: "rgba(255,23,68,1)",
                data: Object.keys(number_of_reactions).map(function(key){return number_of_reactions[key]}),
            }
        ]
    };
    var timetables_by_schools_data = {
        labels: [
            "JHU",
            "UOFT",
            "UMD",
            "Q,ueens"
        ],
        datasets: [
            {
                data: [num_jhu_timetables, num_uoft_timetables, num_umd_timetables, num_queens_timetables],
                backgroundColor: [
                    "#FF6384",
                    "#36A2EB",
                    "#FFCE56",
                    "#FF5722"
                ],
                hoverBackgroundColor: [
                    "#FF6384",
                    "#36A2EB",
                    "#FFCE56",
                    "#FF5722"
                ]
            }]
    };

    var ctx = document.getElementById("timetables_per_hours_chart");
    var line_chart_24_hours = new Chart(ctx, {
        type: 'line',
        data: timetables_per_hour_data,
    });

    var stx = document.getElementById("shared_timetables_per_hours_chart");
    var line_chart_shared_24_hours = new Chart(stx, {
        type: 'line',
        data: shared_timetables_per_hour_data,
    });

    var rtx = document.getElementById("reactions_chart");
    var line_chart_reactions = new Chart(rtx, {
        type: 'bar',
        data: reactions_data,
    });

    var ptx = document.getElementById("timetables_by_schools");
    var myPieChart = new Chart(ptx, {
        type: 'pie',
        data: timetables_by_schools_data,
    });
    </script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script type="text/javascript" src="https://fb.me/react-0.14.3.js"></script>
    <script type="text/javascript" src="https://fb.me/react-dom-0.14.3.js"></script>
    <!--<script type="text/javascript" src="{% static 'js/gulp/analytics_application.js' %}"></script>-->

  </body>
</html>
